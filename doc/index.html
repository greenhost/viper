<!DOCTYPE html><html><head><meta charset="utf-8"><style>html { font-size: 100%; overflow-y: scroll; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; }

body{
  color:#444;
  font-family:Georgia, Palatino, 'Palatino Linotype', Times, 'Times New Roman',
              "Hiragino Sans GB", "STXihei", "微软雅黑", serif;
  font-size:12px;
  line-height:1.5em;
  background:#fefefe;
  width: 45em;
  margin: 10px auto;
  padding: 1em;
  outline: 1300px solid #FAFAFA;
}

a{ color: #0645ad; text-decoration:none;}
a:visited{ color: #0b0080; }
a:hover{ color: #06e; }
a:active{ color:#faa700; }
a:focus{ outline: thin dotted; }
a:hover, a:active{ outline: 0; }

span.backtick {
  border:1px solid #EAEAEA;
  border-radius:3px;
  background:#F8F8F8;
  padding:0 3px 0 3px;
}

::-moz-selection{background:rgba(255,255,0,0.3);color:#000}
::selection{background:rgba(255,255,0,0.3);color:#000}

a::-moz-selection{background:rgba(255,255,0,0.3);color:#0645ad}
a::selection{background:rgba(255,255,0,0.3);color:#0645ad}

p{
margin:1em 0;
}

img{
max-width:100%;
}

h1,h2,h3,h4,h5,h6{
font-weight:normal;
color:#111;
line-height:1em;
}
h4,h5,h6{ font-weight: bold; }
h1{ font-size:2.5em; }
h2{ font-size:2em; border-bottom:1px solid silver; padding-bottom: 5px; }
h3{ font-size:1.5em; }
h4{ font-size:1.2em; }
h5{ font-size:1em; }
h6{ font-size:0.9em; }

blockquote{
color:#666666;
margin:0;
padding-left: 3em;
border-left: 0.5em #EEE solid;
}
hr { display: block; height: 2px; border: 0; border-top: 1px solid #aaa;border-bottom: 1px solid #eee; margin: 1em 0; padding: 0; }


pre , code, kbd, samp { 
  color: #000; 
  font-family: monospace; 
  font-size: 0.88em; 
  border-radius:3px;
  background-color: #F8F8F8;
  border: 1px solid #CCC; 
}
pre { white-space: pre; white-space: pre-wrap; word-wrap: break-word; padding: 5px 12px;}
pre code { border: 0px !important; padding: 0;}
code { padding: 0 3px 0 3px; }

b, strong { font-weight: bold; }

dfn { font-style: italic; }

ins { background: #ff9; color: #000; text-decoration: none; }

mark { background: #ff0; color: #000; font-style: italic; font-weight: bold; }

sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }
sup { top: -0.5em; }
sub { bottom: -0.25em; }

ul, ol { margin: 1em 0; padding: 0 0 0 2em; }
li p:last-child { margin:0 }
dd { margin: 0 0 0 2em; }

img { border: 0; -ms-interpolation-mode: bicubic; vertical-align: middle; }

table { border-collapse: collapse; border-spacing: 0; }
td { vertical-align: top; }

@media only screen and (min-width: 480px) {
body{font-size:14px;}
}

@media only screen and (min-width: 768px) {
body{font-size:16px;}
}

@media print {
  * { background: transparent !important; color: black !important; filter:none !important; -ms-filter: none !important; }
  body{font-size:12pt; max-width:100%; outline:none;}
  a, a:visited { text-decoration: underline; }
  hr { height: 1px; border:0; border-bottom:1px solid black; }
  a[href]:after { content: " (" attr(href) ")"; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after { content: ""; }
  pre, blockquote { border: 1px solid #999; padding-right: 1em; page-break-inside: avoid; }
  tr, img { page-break-inside: avoid; }
  img { max-width: 100% !important; }
  @page :left { margin: 15mm 20mm 15mm 10mm; }
  @page :right { margin: 15mm 10mm 15mm 20mm; }
  p, h2, h3 { orphans: 3; widows: 3; }
  h2, h3 { page-break-after: avoid; }
}
</style></head><body><h1 id="greenhost-openvpn-client-monitor-for-windows">Greenhost OpenVPN client monitor for windows</h1>

<p>This software was designed to be a simple way to control OpenVPN on windows machines
giving accurate feedback about the connection state. The software is composed of two
interdependent programs.</p>

<blockquote>
  <p>WARNING: At the time of this writing this software is still in ALPHA state.
  There is no installer and some manual work is required to install and start the 
  windows service. The windows installer to automate all this should be ready soon.</p>
</blockquote>

<h2 id="the-windows-service">The windows service</h2>

<p>The windows service is the one in charge of opening the connection to the VPN as well as closing it and monitoring its state.</p>

<h4 id="pre-requisites">Pre-requisites</h4>

<p>Install TAP Windows from the client distribution by double-clicking on the installer.</p>

<p>To let the monitor know where the OpenVPN client is, you must have a system-wide environment variable called <em>OPENVPN_HOME</em> that points to the folder where your OpenVPN installation is. Make sure this variable is available to all users, not only to your current user.</p>

<p><img src="./res/envvar.png" alt="illustration1" title="Set environment variable" /></p>

<h4 id="installation">Installation</h4>

<p>To install the windows service you will need to open a <em>Command Prompt</em> in <em>Administrator mode</em>. For this go to your windows menu, right click on the <em>Command Prompt</em> and select the item labeled as <em>Run as administrator</em>.</p>

<p><img src="./res/run_as_admin.png" alt="illustration1" title="Run as admin" /></p>

<p>Once you are at the command prompt, go to the directory where you unpacked the supplied .ZIP file and go into the <em>service</em> folder and run the following commands:</p>

<blockquote>
  <p>c:\unpacked-zip\service> <strong>ovpnmon -install</strong></p>
</blockquote>

<p>This will install the service in your windows machine. To start the service type:</p>

<blockquote>
  <p>c:\unpacked-zip\service> <strong>net start ovpnmon</strong></p>
</blockquote>

<p><strong>ovpnmon</strong> by the way is the name of the service. If you open your Windows Task Manager and go to the <em>services</em> tab you should see it listed there.</p>

<p>From the previous command you should get the following output:</p>

<p><code>
    The OVPN monitor service is starting.
    The OVPN monitor service was started successfully.
</code></p>

<h2 id="the-systray-gui">The systray gui</h2>

<p>Once you start this application it will sit rather quietly in your system tray until you establish the connection. You do not have to install this one, it is a self-standing executable. You may place it in your <em>Start Up</em> items if you wish to have it available upon startup.</p>

<p><img src="./res/configure.png" alt="illustration2" title="Configure the VPN client" /></p>

<p>Choose <strong>Configure...</strong> to set the configuration file provided by your VPN administrator. This configuration file will be used in every subsequent connection.</p>

<p><img src="./res/validate.png" alt="illustration3" title="Validate your connection against a server within the VPN network" /></p>

<blockquote>
  <p>The GUI client provides a way to validate the VPN connection against a preconfigured server 
  inside of the VPN. This is useful as a double check, but please be mindful that this is not 
  foolproof and if your network has been compromised it would be easy to fool the browser with a 
  fake page. So trust only what the system tray icon says.</p>
</blockquote>

<p>When you click on <em>Go online...</em> the client will take a few seconds to initialize the connection. Please wait untill your connection is secured.</p>

<p><img src="./res/connecting.png" alt="illustration4" title="Opening the connection to the VPN takes a few seconds" /></p>

<p>You are now connected to the VPN. Plase validate the IP address of the gateway and the address of your interface, to make absolutely sure that your connection is secured.</p>

<p><img src="./res/connected.png" alt="illustration5" title="You are now connected to the VPN" /></p>
</body></html>